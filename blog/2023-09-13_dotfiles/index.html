<!doctype html><html lang=en><head><title>How I Organized My Dotfiles | Axel's Webpage</title>
<link rel=canonical href=https://axelvanherle.xyz/><link rel=alternate type=application/rss+xml title="Axel's Webpage RSS" href=/index.xml><link rel=stylesheet type=text/css href=/style.css><link rel=icon href=/favicon.ico><meta name=description content="How i organized my dotfiles using git.
It seems appropriate to start this post off with giving an explanation as to why i would want to do this.
Luckily this is simple to explain; I&rsquo;m a lazy fucker, that&rsquo;s why. No really, that&rsquo;s pretty much all there is too it. I simply wanted to make the process of syncing my dotfiles to and from multiple of my systems (most notably my laptop and my desktop) easier."><meta name=keywords content="linux"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><meta charset=utf-8></head><body><main><header><h1 id="tag_How i organized my dotfiles">How i organized my dotfiles</h1></header><article><h1 id=how-i-organized-my-dotfiles-using-git>How i organized my dotfiles using git.</h1><p>It seems appropriate to start this post off with giving an explanation as to <em>why</em> i would want to do this.</p><p>Luckily this is simple to explain; I&rsquo;m a lazy fucker, that&rsquo;s why. No really, that&rsquo;s pretty much all there is too it. I simply wanted to make the process of syncing my dotfiles to and from multiple of my systems (most notably my laptop and my desktop) easier.</p><p>I used to do this manually, where i had set up a repo where i would manually <code>cp</code> and then <code>mv</code> my config files into them, but this took minutes. Like i said, I&rsquo;m lazy and had time on my hands.</p><h2 id=how-i-did-it>How i did it</h2><p>I took some inspiration from <a href=https://www.atlassian.com/git/tutorials/dotfiles>atlassian&rsquo;s</a> blogpost. They also took some inspiration so it&rsquo;s a <a href="https://youtu.be/Lr-KHezBqX0?t=242">https://youtu.be/Lr-KHezBqX0?t=242</a> typa situation we got on our hands.</p><p>With that disclosure out of the way; here&rsquo;s how i did it.</p><p>To get things started i set up a bare git repo in my home dir named <code>.cfg</code> (cfg is short for config). I had actually never even heard of a bare repo, but after learning about it, it really seemed the play to sync and manage my dotfiles. To keep things short, the advantage of a bare repo is that I&rsquo;m tracking the actual config files themselves, instead of symlinking or manually copying my config files to a working directory.</p><p>I did this by doing a simple <code>git init --bare $HOME/.cfg</code>. All this does is create a bare git repo inside <code>$HOME</code>, or in other words home sweet home.</p><p>After that i set up the alias <code>config='/usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME'</code>. We do this so we have a simple command we can use where-ever we are in our system to interact with our config files. This works by executing git and specifying that we are using the <code>$HOME/.cfg</code> repo. We also set the working tree, aka the directory which our git repo is supposed to be tracking. Since we are managing our dotfiles, we are tracking <code>$HOME</code>. If you are a more organized user than i am, you could do all of this inside <code>~/.config</code>.</p><p>I simply put this alias inside my <code>.zshrc</code>, since that&rsquo;s my preferred shell.</p><p>Then we tell our git repo to not show us any untracked files by setting <code>config config --local status.showUntrackedFiles no</code> this flag. All this does is make sure we aren&rsquo;t bombarded with a huge list of untracked files when doing <code>config status</code>.</p><p>That was all when it comes to setting up our local repo. We&rsquo;ve now successfully set up a git repo to <em>locally</em> sync our files. But you might ask, how do i access this repo from a different machine? And to be honest, that&rsquo;s a great question. I used github for this, but you can use whatever you want.</p><p>If you do decide to use github you need to add the remote repository to you local configuration (something you need to do for any remote repo). I simply ran <code>config remote add origin git@github.com:&lt;your username>/&lt;name of your gh repo>.git</code></p><p>Keep in mind that you do need valid SSH keys for this to work, i had to generate a pair and add them to my github account.</p><p>After this you are able to push and pull to your remote github repo using all your regular git commands, but instead of git we are using the <code>config</code> alias that we just setup. Imagine running commands like <code>config commit -am "rewrite nvim config"</code>, <code>config status</code>, <code>config push</code>,&mldr;</p><p>We currently have this git repo setup on one machine, but there are a few steps to get it setup on another machine.</p><p>First things first is setting up a safety net on our local machine before pushing it to remote. We don&rsquo;t want to be encountering any weird recursion scenarios, and to make sure this does not happen is by adding <code>.cfg</code> to our <code>.gitignore</code>. One can do this by running <code>echo ".cfg" >> .gitignore</code>. Then we add this file to our git repo by running <code>config add .gitignore</code>. Make sure to also push this to the remote repo by committing it and pushing doing <code>config commit -am "add .cfg to .gitignore"</code> and <code>config push</code>.</p><p>After setting up our safety net, we are safeguarded from any recursion issues and we are ready to clone to another machine.</p><p>To clone our repo simply run <code>git clone --bare &lt;git-repo-url> $HOME/.cfg</code>. This command clones the repo to <code>.cfg</code> located in your home directory. After cloning we set up a alias in our current shell scope by running <code>alias config='/usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME'</code>. We do this in this scope because your freshly pushed dotfiles should contain this alias, so if you haven&rsquo;t added it already now is the time.</p><p>When we have the repo cloned we are ready to checkout our freshly cloned repo. In simple terms, this deploys our dotfiles on our system. To do this, run <code>config checkout</code>. You might get an error about overwriting files. To &ldquo;fix&rdquo; this error we are going to be moving the files that are giving us trouble into a different folder named <code>.config-backup</code>. We do this in the off-chance anything goes wrong.</p><p>Run</p><pre tabindex=0><code>sudo mkdir -p .config-backup &amp;&amp; \
config checkout 2&gt;&amp;1 | grep -E &#34;\s+\.&#34; | awk {&#39;print $1&#39;} | \
while read -r file; do
    dir=$(dirname &#34;.config-backup/${file}&#34;)
    mkdir -p &#34;${dir}&#34;
    mv &#34;${file}&#34; &#34;.config-backup/${file}&#34;
done &amp;&amp; config config --local status.showUntrackedFiles no
</code></pre><p>This is mostly freeloading off the original guides script, but i had an issue where it didn&rsquo;t create parent directories so i added the while loop with a little bit of help from my buddy ChatGPT. I also added the <code>config config --local status.showUntrackedFiles no</code> line at the end, so we don&rsquo;t have to run that separately. Like i said, I&rsquo;m lazy.</p><p>Once that has run without any errors you&rsquo;re done, you can now clone and sync your dotfiles on as many systems as you want.</p><div id=nextprev><a href=/about/><div id=prevart>Previous:<br>About</div></a><a href=/blog/2023-10-25_kibsite/><div id=nextart>Next:<br>My ~25 KiB site is simply better; ranting about the current state of the web, soydevs beware.</div></a></div><div style=clear:both class=taglist>Related<br><a id=tag_linux href=https://axelvanherle.xyz/tags/linux>Linux</a></div></article></main><footer><a href=https://axelvanherle.xyz/>https://axelvanherle.xyz/</a><br><br><a href=/index.xml><img src=/rss.svg style=max-height:1.5em alt="RSS Feed" title="Subscribe via RSS for updates."></a></footer></body></html>